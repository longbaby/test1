<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:context="http://www.springframework.org/schema/context" xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
            http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.1.xsd
            http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
            http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd"
    default-lazy-init="false">

    <bean id="captchaService" class="com.icbc.emall.common.security.jcaptcha.JCaptchaServiceProxyImpl">
        <property name="jcaptchaService" ref="imageCaptchaService"/>
    </bean>
    
    <bean id="captchaServiceProxy" class="com.icbc.emall.common.security.jcaptcha.JCaptchaServiceProxyImpl">
		<property name="jcaptchaService" ref="imageCaptchaService" />
	</bean>
	
	<bean id="casValidateCodeFilter" class="com.icbc.emall.web.filter.CasValidateCodeFilter">
		<property name="captchaServiceProxy" ref="captchaServiceProxy"></property>
	</bean>

    <bean id="imageCaptchaService" class="com.octo.captcha.service.image.DefaultManageableImageCaptchaService">
        <constructor-arg type="com.octo.captcha.service.captchastore.CaptchaStore" index="0" ref="fastHashMapCaptchaStore"/>
        <constructor-arg type="com.octo.captcha.engine.CaptchaEngine" index="1" ref="imageEngine"/>
        <constructor-arg index="2" value="180"/>
        <constructor-arg index="3" value="100000"/>
        <constructor-arg index="4" value="75000"/>
    </bean>

    <bean id="fastHashMapCaptchaStore"
       class="com.octo.captcha.service.captchastore.FastHashMapCaptchaStore"/>
       
     <bean id="seckillFastHashMapCaptchaStore"
       class="com.octo.captcha.service.captchastore.FastHashMapCaptchaStore"/>

       
    <!-- ===================== CAPTCHA IMAGE CONFIG ==================== -->
    
    <bean id="imageEngine" class="com.octo.captcha.engine.GenericCaptchaEngine">
        <constructor-arg index="0">
            <list>
                <ref bean="imageCaptchaFactory"/>
            </list>
        </constructor-arg>
    </bean>
    <bean id="imageCaptchaFactory" class="com.octo.captcha.image.gimpy.GimpyFactory">
        <constructor-arg>
            <ref bean="wordgen"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="wordtoimage"/>
        </constructor-arg>
    </bean>
    <bean id="wordgen" class="com.octo.captcha.component.word.wordgenerator.ComposeDictionaryWordGenerator">
        <constructor-arg>
            <ref bean="filedict"/>
        </constructor-arg>
    </bean>
    <bean id="filedict" class="com.octo.captcha.component.word.FileDictionary">
        <constructor-arg index="0">
            <value>toddlist</value>
        </constructor-arg>
    </bean>
    <bean id="wordtoimage" class="com.octo.captcha.component.image.wordtoimage.DeformedComposedWordToImage">
        <constructor-arg index="0">
            <ref bean="fontGenRandom"/>
        </constructor-arg>
        <constructor-arg index="1">
            <ref bean="backGenFunky"/>
        </constructor-arg>
        <constructor-arg index="2">
            <ref bean="simpleWhitePaster"/>
        </constructor-arg>
        <constructor-arg index="3">
            <ref bean="backgroundDeformation"/>
        </constructor-arg>
        <constructor-arg index="4">
            <ref bean="textDeformation"/>
        </constructor-arg>
        <constructor-arg index="5">
            <ref bean="finalDeformation"/>
        </constructor-arg>
    </bean>
    <bean id="fontGenRandom" class="com.octo.captcha.component.image.fontgenerator.RandomFontGenerator">
        <constructor-arg index="0">
            <value>21</value>
        </constructor-arg>
        <constructor-arg index="1">
            <value>21</value>
        </constructor-arg>
        <constructor-arg index="2">
            <list>
                <ref bean="fontArial"/>
            </list>
        </constructor-arg>
    </bean>
    <bean id="fontArial" class="java.awt.Font">
        <constructor-arg index="0">
            <value>Arial</value>
        </constructor-arg>
        <constructor-arg index="1">
            <value>0</value>
        </constructor-arg>
        <constructor-arg index="2">
            <value>12</value>
        </constructor-arg>
    </bean>
    <bean id="backGenFunky" class="com.octo.captcha.component.image.backgroundgenerator.FunkyBackgroundGenerator">
        <constructor-arg index="0">
            <value>66</value>
        </constructor-arg>
        <constructor-arg index="1">
            <value>21</value>
        </constructor-arg>
        <constructor-arg index="2">
            <ref bean="colorGenRandomLite"/>
        </constructor-arg>
        <constructor-arg index="3">
            <ref bean="colorGenRandomLite"/>
        </constructor-arg>
        <constructor-arg index="4">
            <ref bean="colorGenRandomLite"/>
        </constructor-arg>
        <constructor-arg index="5">
            <ref bean="colorGenRandomLite"/>
        </constructor-arg>
        <constructor-arg index="6">
            <value>1.2</value>
        </constructor-arg>
    </bean>
    <bean id="simpleWhitePaster" class="com.octo.captcha.component.image.textpaster.SimpleTextPaster">
        <constructor-arg type="java.lang.Integer" index="0">
            <value>4</value>
        </constructor-arg>
        <constructor-arg type="java.lang.Integer" index="1">
            <value>4</value>
        </constructor-arg>
        <constructor-arg type="com.octo.captcha.component.image.color.ColorGenerator" index="2">
            <ref bean="colorGenRandomDark"/>
        </constructor-arg>
        <constructor-arg index="3">
            <value>true</value>
        </constructor-arg>
    </bean>
    <bean id="colorGenRandomLite" class="com.octo.captcha.component.image.color.RandomRangeColorGenerator">
        <constructor-arg index="0">
            <list>
                <value>150</value>
                <value>255</value>
            </list>
        </constructor-arg>
        <constructor-arg index="1">
            <list>
                <value>150</value>
                <value>255</value>
            </list>
        </constructor-arg>
        <constructor-arg index="2">
            <list>
                <value>150</value>
                <value>255</value>
            </list>
        </constructor-arg>
        <constructor-arg index="3">
            <list>
                <value>200</value>
                <value>255</value>
            </list>
        </constructor-arg>
    </bean>
    <bean id="colorGenRandomDark" class="com.octo.captcha.component.image.color.RandomRangeColorGenerator">
        <constructor-arg index="0">
            <list>
                <value>0</value>
                <value>0</value>
            </list>
        </constructor-arg>
        <constructor-arg index="1">
            <list>
                <value>0</value>
                <value>0</value>
            </list>
        </constructor-arg>
        <constructor-arg index="2">
            <list>
                <value>0</value>
                <value>0</value>
            </list>
        </constructor-arg>
        <constructor-arg index="3">
            <list>
                <value>200</value>
                <value>255</value>
            </list>
        </constructor-arg>
    </bean>
    <bean id="backgroundDeformation" class="com.octo.captcha.component.image.deformation.PuzzleImageDeformation">
        <constructor-arg index="0">
            <value>1</value>
        </constructor-arg>
        <constructor-arg index="1">
            <value>1</value>
        </constructor-arg>
        <constructor-arg index="2">
            <value>0</value>
        </constructor-arg>
    </bean>
    <bean id="textDeformation" class="com.octo.captcha.component.image.deformation.PuzzleImageDeformation">
        <constructor-arg index="0">
            <value>1</value>
        </constructor-arg>
        <constructor-arg index="1">
            <value>1</value>
        </constructor-arg>
        <constructor-arg index="2">
            <value>0</value>
        </constructor-arg>
    </bean>
    <bean id="finalDeformation" class="com.octo.captcha.component.image.deformation.PuzzleImageDeformation">
        <constructor-arg index="0">
            <value>1</value>
        </constructor-arg>
        <constructor-arg index="1">
            <value>1</value>
        </constructor-arg>
        <constructor-arg index="2">
            <value>0</value>
        </constructor-arg>
    </bean>
    
    
    
    
    
    
    
    
    
     <!-- ===================================================== -->
    
    <bean id="seckillCaptchaService" class="com.icbc.emall.common.security.jcaptcha.JCaptchaServiceProxyImpl">
        <property name="jcaptchaService" ref="seckillImageCaptchaService"/>
    </bean>
    
     <bean id="seckillImageCaptchaService" class="com.octo.captcha.service.image.DefaultManageableImageCaptchaService">
        <constructor-arg type="com.octo.captcha.service.captchastore.CaptchaStore" index="0" ref="seckillFastHashMapCaptchaStore"/>
        <constructor-arg type="com.octo.captcha.engine.CaptchaEngine" index="1" ref="seckillImageEngine"/>
        <constructor-arg index="2" value="180"/>
        <constructor-arg index="3" value="100000"/>
        <constructor-arg index="4" value="75000"/>
    </bean>
        
    <bean id="seckillImageEngine" class="com.octo.captcha.engine.GenericCaptchaEngine">
        <constructor-arg index="0">
            <list>
                <ref bean="seckillImageCaptchaFactory"/>
            </list>
        </constructor-arg>
    </bean>
    
     <bean id="seckillImageCaptchaFactory" class="com.octo.captcha.image.gimpy.GimpyFactory">
        <constructor-arg>
            <ref bean="seckillWordgen"/>
        </constructor-arg>
        <constructor-arg>
            <ref bean="seckillWordtoimage"/>
        </constructor-arg>
    </bean>
    
    
    
    <bean id="seckillWordgen" class="com.octo.captcha.component.word.wordgenerator.ComposeDictionaryWordGenerator">
        <constructor-arg>
            <ref bean="seckillFiledict"/>
        </constructor-arg>
    </bean>
    <bean id="seckillFiledict" class="com.octo.captcha.component.word.FileDictionary">
        <constructor-arg index="0">
            <value>toddlist</value>
        </constructor-arg>
    </bean>
    
    <bean id="seckillWordtoimage" class="com.octo.captcha.component.image.wordtoimage.DeformedComposedWordToImage">
        <constructor-arg index="0">
            <ref bean="seckillFontGenRandom"/>
        </constructor-arg>
        <constructor-arg index="1">
            <ref bean="seckillBackGenFunky"/>
        </constructor-arg>
        <constructor-arg index="2">
            <ref bean="simpleWhitePaster"/>
        </constructor-arg>
        <constructor-arg index="3">
            <ref bean="backgroundDeformation"/>
        </constructor-arg>
        <constructor-arg index="4">
            <ref bean="textDeformation"/>
        </constructor-arg>
        <constructor-arg index="5">
            <ref bean="finalDeformation"/>
        </constructor-arg>
    </bean>
    
     <bean id="seckillFontGenRandom" class="com.octo.captcha.component.image.fontgenerator.RandomFontGenerator">
        <constructor-arg index="0">
            <value>21</value>
        </constructor-arg>
        <constructor-arg index="1">
            <value>21</value>
        </constructor-arg>
        <constructor-arg index="2">
            <list>
                <ref bean="fontZhCn"/>
                <ref bean="fontZhCn1"/>
                <ref bean="fontZhCn2"/>
                <ref bean="fontZhCn3"/>
                <ref bean="fontZhCn4"/>
            </list>
        </constructor-arg>
    </bean>
    
    
    <!-- 中文  -->
     <bean id="fontZhCn" class="java.awt.Font">
        <constructor-arg index="0" value="\u5b8b\u4f53"></constructor-arg>
        <constructor-arg index="1" value="0"></constructor-arg>
        <constructor-arg index="2" value="8"></constructor-arg>
    </bean>
     <bean id="fontZhCn1" class="java.awt.Font">
        <constructor-arg index="0" value="\u65b0\u5b8b\u4f53"></constructor-arg>
        <constructor-arg index="1" value="0"></constructor-arg>
        <constructor-arg index="2" value="8"></constructor-arg>
    </bean>
    <bean id="fontZhCn2" class="java.awt.Font">
        <constructor-arg index="0" value="\u9ed1\u4f53"></constructor-arg>
        <constructor-arg index="1" value="0"></constructor-arg>
        <constructor-arg index="2" value="8"></constructor-arg>
    </bean>
    <bean id="fontZhCn3" class="java.awt.Font">
        <constructor-arg index="0" value="\u6977\u4f53"></constructor-arg>
        <constructor-arg index="1" value="0"></constructor-arg>
        <constructor-arg index="2" value="8"></constructor-arg>
    </bean>
    <bean id="fontZhCn4" class="java.awt.Font">
        <constructor-arg index="0" value="\u96b6\u4e66"></constructor-arg>
        <constructor-arg index="1" value="0"></constructor-arg>
        <constructor-arg index="2" value="8"></constructor-arg>
    </bean>
    <!-- 中文  -->
    
    
       <bean id="seckillBackGenFunky" class="com.octo.captcha.component.image.backgroundgenerator.FunkyBackgroundGenerator">
        <constructor-arg index="0">
            <value>100</value>
        </constructor-arg>
        <constructor-arg index="1">
            <value>25</value>
        </constructor-arg>
        <constructor-arg index="2">
            <ref bean="colorGenRandomLite"/>
        </constructor-arg>
        <constructor-arg index="3">
            <ref bean="colorGenRandomLite"/>
        </constructor-arg>
        <constructor-arg index="4">
            <ref bean="colorGenRandomLite"/>
        </constructor-arg>
        <constructor-arg index="5">
            <ref bean="colorGenRandomLite"/>
        </constructor-arg>
        <constructor-arg index="6">
            <value>1.2</value>
        </constructor-arg>
    </bean>
</beans>

